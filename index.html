<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GemGPT - Advanced AI Intellectual Partner</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --accent-color: #f59e0b;
            --light-color: #f3f4f6;
            --dark-color: #1f2937;
            --sidebar-color: #111827;
            --success-color: #10b981;
            --error-color: #ef4444;
            --thinking-color: #6366f1;
            --user-msg-color: #3b82f6;
            --ai-msg-color: #4b5563;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #0f172a;
            color: #e2e8f0;
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background-color: var(--sidebar-color);
            display: flex;
            flex-direction: column;
            border-right: 1px solid #374151;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid #374151;
        }

        .sidebar-header h2 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
        }

        .new-chat-btn {
            margin: 15px;
            padding: 12px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-weight: 500;
            transition: background-color 0.2s;
        }

        .new-chat-btn:hover {
            background-color: var(--secondary-color);
        }

        .chat-history {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .chat-item {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: background-color 0.2s;
        }

        .chat-item:hover {
            background-color: #1f2937;
        }

        .chat-item.active {
            background-color: #1e3a8a;
        }

        .chat-item i {
            font-size: 0.9rem;
        }

        .sidebar-footer {
            padding: 15px;
            border-top: 1px solid #374151;
            font-size: 0.8rem;
            color: #9ca3af;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 16px 24px;
            background-color: #1f2937;
            border-bottom: 1px solid #374151;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
        }

        .chat-title {
            font-size: 1.2rem;
            font-weight: 500;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .message {
            max-width: 80%;
            padding: 16px 20px;
            border-radius: 12px;
            line-height: 1.5;
        }

        .user-message {
            align-self: flex-end;
            background-color: var(--user-msg-color);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .ai-message {
            align-self: flex-start;
            background-color: var(--ai-msg-color);
            color: white;
            border-bottom-left-radius: 4px;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .thinking-indicator {
            display: none;
            padding: 16px;
            background-color: var(--thinking-color);
            color: white;
            border-radius: 12px;
            margin: 10px 0;
            align-self: flex-start;
            max-width: 80%;
        }

        .thinking-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .thinking-dots {
            display: flex;
            gap: 4px;
        }

        .thinking-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: white;
            animation: pulse 1.5s infinite ease-in-out;
        }

        .thinking-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .thinking-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.4; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        .chat-input-container {
            padding: 16px 24px;
            background-color: #1f2937;
            border-top: 1px solid #374151;
        }

        .chat-input-form {
            display: flex;
            gap: 12px;
        }

        .chat-input {
            flex: 1;
            padding: 14px 16px;
            background-color: #374151;
            color: white;
            border: 1px solid #4b5563;
            border-radius: 8px;
            outline: none;
            font-size: 1rem;
            resize: none;
            min-height: 56px;
            max-height: 200px;
        }

        .chat-input:focus {
            border-color: var(--primary-color);
        }

        .send-button {
            padding: 0 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .send-button:hover {
            background-color: var(--secondary-color);
        }

        .error-message {
            color: var(--error-color);
            padding: 10px;
            margin-top: 10px;
            border-radius: 5px;
            background-color: rgba(239, 68, 68, 0.1);
            display: none;
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .sidebar {
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                z-index: 100;
                transform: translateX(-100%);
            }
            
            .sidebar.open {
                transform: translateX(0);
            }
            
            .menu-toggle {
                display: block;
            }
            
            .message {
                max-width: 90%;
            }
        }

        /* Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1f2937;
        }

        ::-webkit-scrollbar-thumb {
            background: #4b5563;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #6b7280;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2><i class="fas fa-robot"></i> GemGPT</h2>
        </div>
        <button class="new-chat-btn" id="new-chat-btn">
            <i class="fas fa-plus"></i> New Chat
        </button>
        <div class="chat-history" id="chat-history">
            <!-- Chat items will be added here dynamically -->
        </div>
        <div class="sidebar-footer">
            <p>GemGPT v1.0 | Advanced AI Intellectual Partner</p>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="chat-header">
            <button class="menu-toggle" id="menu-toggle">
                <i class="fas fa-bars"></i>
            </button>
            <div class="chat-title" id="chat-title">New Chat</div>
            <div></div> <!-- Empty div for spacing -->
        </div>
        
        <div class="chat-messages" id="chat-messages">
            <div class="message ai-message">
                <div class="message-header">
                    <i class="fas fa-robot"></i> GemGPT
                </div>
                Halo. Saya GemGPT, mitra adu gagasan Anda. Saya di sini untuk menantang pemikiran Anda, menguji asumsi, dan membantu Anda mencapai pemahaman yang lebih kokoh dan bebas bias. Saya akan jujur, analitis, dan tidak segan menantang Anda. Apa ide atau klaim yang ingin Anda uji hari ini?
            </div>
        </div>
        
        <div class="thinking-indicator" id="thinking-indicator">
            <div class="thinking-content">
                <div class="thinking-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                <span>GemGPT sedang menganalisis dan merespons...</span>
            </div>
        </div>
        
        <div class="error-message" id="error-message"></div>
        
        <div class="chat-input-container">
            <form class="chat-input-form" id="chat-form">
                <textarea class="chat-input" id="user-input" placeholder="Ketik ide atau klaim Anda di sini..." rows="1" autocomplete="off"></textarea>
                <button type="submit" class="send-button">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const sidebar = document.getElementById('sidebar');
            const menuToggle = document.getElementById('menu-toggle');
            const chatMessages = document.getElementById('chat-messages');
            const userInput = document.getElementById('user-input');
            const chatForm = document.getElementById('chat-form');
            const thinkingIndicator = document.getElementById('thinking-indicator');
            const errorMessage = document.getElementById('error-message');
            const newChatBtn = document.getElementById('new-chat-btn');
            const chatHistory = document.getElementById('chat-history');
            const chatTitle = document.getElementById('chat-title');
            
            // State variables
            let currentChatId = 'chat-' + Date.now();
            let chats = JSON.parse(localStorage.getItem('gemgpt-chats')) || {};
            
            // Initialize the application
            function init() {
                // Load chat history
                loadChatHistory();
                
                // Load current chat if exists
                if (chats[currentChatId]) {
                    loadChat(currentChatId);
                } else {
                    // Create new chat entry
                    chats[currentChatId] = {
                        id: currentChatId,
                        title: 'New Chat',
                        messages: [
                            {
                                sender: 'ai',
                                content: 'Halo. Saya GemGPT, mitra adu gagasan Anda. Saya di sini untuk menantang pemikiran Anda, menguji asumsi, dan membantu Anda mencapai pemahaman yang lebih kokoh dan bebas bias. Saya akan jujur, analitis, dan tidak segan menantang Anda. Apa ide atau klaim yang ingin Anda uji hari ini?',
                                timestamp: Date.now()
                            }
                        ],
                        timestamp: Date.now()
                    };
                    saveChats();
                }
                
                // Set up event listeners
                setupEventListeners();
            }
            
            // Set up event listeners
            function setupEventListeners() {
                // Toggle sidebar on mobile
                menuToggle.addEventListener('click', function() {
                    sidebar.classList.toggle('open');
                });
                
                // Form submission
                chatForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    sendMessage();
                });
                
                // Auto-resize textarea
                userInput.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = (this.scrollHeight) + 'px';
                });
                
                // Create new chat
                newChatBtn.addEventListener('click', createNewChat);
            }
            
            // Load chat history from localStorage
            function loadChatHistory() {
                chatHistory.innerHTML = '';
                
                // Get chats and sort by timestamp (newest first)
                const chatArray = Object.values(chats).sort((a, b) => b.timestamp - a.timestamp);
                
                if (chatArray.length === 0) {
                    chatHistory.innerHTML = '<p style="padding: 20px; text-align: center; color: #9ca3af;">No chat history</p>';
                    return;
                }
                
                chatArray.forEach(chat => {
                    const chatItem = document.createElement('div');
                    chatItem.classList.add('chat-item');
                    if (chat.id === currentChatId) {
                        chatItem.classList.add('active');
                    }
                    
                    chatItem.innerHTML = `
                        <i class="fas fa-message"></i>
                        <span>${chat.title}</span>
                    `;
                    
                    chatItem.addEventListener('click', () => {
                        loadChat(chat.id);
                        if (window.innerWidth < 768) {
                            sidebar.classList.remove('open');
                        }
                    });
                    
                    chatHistory.appendChild(chatItem);
                });
            }
            
            // Load a specific chat
            function loadChat(chatId) {
                const chat = chats[chatId];
                if (!chat) return;
                
                // Update current chat ID
                currentChatId = chatId;
                
                // Update UI
                chatTitle.textContent = chat.title;
                
                // Clear messages and reload
                chatMessages.innerHTML = '';
                chat.messages.forEach(message => {
                    addMessageToUI(message.content, message.sender === 'user');
                });
                
                // Update chat history highlights
                document.querySelectorAll('.chat-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                const currentChatItem = Array.from(document.querySelectorAll('.chat-item')).find(item => {
                    return item.textContent.includes(chat.title);
                });
                
                if (currentChatItem) {
                    currentChatItem.classList.add('active');
                }
                
                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Create a new chat
            function createNewChat() {
                const newChatId = 'chat-' + Date.now();
                currentChatId = newChatId;
                
                // Create new chat entry
                chats[newChatId] = {
                    id: newChatId,
                    title: 'New Chat',
                    messages: [
                        {
                            sender: 'ai',
                            content: 'Halo. Saya GemGPT, mitra adu gagasan Anda. Saya di sini untuk menantang pemikiran Anda, menguji asumsi, dan membantu Anda mencapai pemahaman yang lebih kokoh dan bebas bias. Saya akan jujur, analitis, dan tidak segan menantang Anda. Apa ide atau klaim yang ingin Anda uji hari ini?',
                            timestamp: Date.now()
                        }
                    ],
                    timestamp: Date.now()
                };
                
                // Save and update UI
                saveChats();
                loadChat(newChatId);
                loadChatHistory();
                
                // Clear input
                userInput.value = '';
                userInput.style.height = 'auto';
            }
            
            // Save chats to localStorage
            function saveChats() {
                localStorage.setItem('gemgpt-chats', JSON.stringify(chats));
            }
            
            // Add message to UI
            function addMessageToUI(text, isUser = false) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(isUser ? 'user-message' : 'ai-message');
                
                const messageHeader = document.createElement('div');
                messageHeader.classList.add('message-header');
                messageHeader.innerHTML = isUser ? 
                    '<i class="fas fa-user"></i> You' : 
                    '<i class="fas fa-robot"></i> GemGPT';
                
                messageDiv.appendChild(messageHeader);
                messageDiv.appendChild(document.createTextNode(text));
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
            
            // Show error message
            function showError(message) {
                errorMessage.textContent = message;
                errorMessage.style.display = 'block';
                setTimeout(() => {
                    errorMessage.style.display = 'none';
                }, 5000);
            }
            
            // Send message to AI
            async function sendMessage() {
                const message = userInput.value.trim();
                if (!message) return;
                
                // Add user message to UI
                addMessageToUI(message, true);
                
                // Add to chat history
                chats[currentChatId].messages.push({
                    sender: 'user',
                    content: message,
                    timestamp: Date.now()
                });
                
                // Update chat title if it's the first user message
                if (chats[currentChatId].messages.filter(m => m.sender === 'user').length === 1) {
                    const newTitle = message.length > 30 ? message.substring(0, 30) + '...' : message;
                    chats[currentChatId].title = newTitle;
                    chatTitle.textContent = newTitle;
                }
                
                // Clear input
                userInput.value = '';
                userInput.style.height = 'auto';
                
                // Show thinking indicator
                thinkingIndicator.style.display = 'block';
                
                try {
                    // Generate AI response
                    const response = await generateAIResponse(message, chats[currentChatId].messages);
                    
                    // Hide thinking indicator
                    thinkingIndicator.style.display = 'none';
                    
                    // Add AI response to UI and history
                    if (response && response.text) {
                        addMessageToUI(response.text, false);
                        
                        chats[currentChatId].messages.push({
                            sender: 'ai',
                            content: response.text,
                            timestamp: Date.now()
                        });
                        
                        // Update chat history
                        saveChats();
                        loadChatHistory();
                    } else {
                        throw new Error('No response from AI');
                    }
                } catch (error) {
                    thinkingIndicator.style.display = 'none';
                    showError('Error: ' + error.message);
                    addMessageToUI('Maaf, saya mengalami kesalahan teknis. Bisakah Anda mencoba lagi atau merumuskan ulang pertanyaannya?', false);
                }
            }
            
            // Generate AI response based on message and context
            async function generateAIResponse(message, messageHistory) {
                try {
                    // Simulate API delay
                    await new Promise(resolve => setTimeout(resolve, 1000 + Math.random() * 2000));
                    
                    // Check if it's a greeting or simple message
                    const lowerMessage = message.toLowerCase();
                    
                    if (lowerMessage.includes('halo') || lowerMessage.includes('hai') || 
                        lowerMessage.includes('hello') || lowerMessage.includes('hi')) {
                        return { 
                            text: "Halo! Saya GemGPT, mitra diskusi analitis Anda. Daripada sekadar menyapa, apakah ada topik, ide, atau klaim spesifik yang ingin Anda uji dan dalami bersama? Saya di sini untuk menantang pemikiran Anda dan membantu mengembangkan argumen yang lebih kokoh." 
                        };
                    }
                    
                    // Check if it's a thank you message
                    if (lowerMessage.includes('terima kasih') || lowerMessage.includes('thanks') || 
                        lowerMessage.includes('thank you')) {
                        return { 
                            text: "Sama-sama. Ingat, tujuan saya bukan untuk membuat Anda merasa nyaman, tetapi untuk membantu Anda mencapai pemahaman yang lebih mendalam dan bebas bias. Apakah ada aspek lain dari diskusi kita yang perlu kita eksplorasi lebih dalam?" 
                        };
                    }
                    
                    // Analyze the conversation context for more relevant responses
                    const lastFewMessages = messageHistory.slice(-4); // Get last 4 messages for context
                    
                    // Check if user is asking for explanation or examples
                    if (lowerMessage.includes('contoh') || lowerMessage.includes('contohnya') || 
                        lowerMessage.includes('contohnya') || lowerMessage.includes('example') ||
                        lowerMessage.includes('contoh')) {
                        return { 
                            text: "Baik, berikut contoh konkret untuk ilustrasi: Misalnya Anda berargumen bahwa 'teknologi selalu meningkatkan produktivitas'. Mari kita uji ini. Asumsi tersembunyi: bahwa teknologi selalu diterapkan dengan efektif dan tidak memiliki dampak negatif yang signifikan. Kontra-argumen: Dalam banyak kasus, teknologi justru menciptakan gangguan (notifikasi terus-menerus) dan memerlukan waktu adaptasi yang justru mengurangi produktivitas jangka pendek. Perspektif alternatif: Dari sudut pandang sosiologis, teknologi dapat mengubah struktur sosial dan pola kerja secara mendalam, tidak selalu linear terhadap produktivitas." 
                        };
                    }
                    
                    // Default analytical response for substantive messages
                    if (message.length > 5) {
                        return {
                            text: `Anda menyatakan: "${message}". 

1. Asumsi yang perlu diuji: Anda tampaknya berasumsi bahwa pernyataan ini berlaku universal atau tidak memiliki pengecualian. Benarkah demikian?

2. Kontra-argumen: Seorang kritikus mungkin berpendapat bahwa pernyataan ini mengabaikan [faktor penting] dan tidak mempertimbangkan [perspektif alternatif].

3. Uji konsistensi: Apakah pernyataan ini konsisten dengan keyakinan atau pernyataan lain yang Anda miliki? 

4. Perspektif alternatif: Dari sudut pandang [disiplin ilmu terkait], pernyataan ini bisa dilihat sebagai [interpretasi alternatif].

Bisakah Anda menjelaskan lebih detail apa yang mendasari pernyataan ini, atau adakah aspek spesifik yang ingin kita eksplorasi lebih dalam?`
                        };
                    }
                    
                    // For very short messages
                    return {
                        text: "Saya mendeteksi bahwa pesan Anda sangat singkat. Sebagai mitra analitis, saya dirancang untuk mengeksplorasi ide dan argumen yang kompleks. Bisakah Anda menguraikan pemikiran atau klaim yang ingin Anda diskusikan dengan lebih detail?"
                    };
                    
                } catch (error) {
                    console.error('AI Response Error:', error);
                    return { error: error.message };
                }
            }
            
            // Initialize the app
            init();
        });
    </script>
</body>
</html>
